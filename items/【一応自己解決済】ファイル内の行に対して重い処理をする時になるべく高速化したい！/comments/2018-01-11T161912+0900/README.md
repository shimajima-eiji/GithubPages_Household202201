@packet なるほど確かに、先にソートをするとロジック側がだいぶ楽になりますね！
アドバイス、ありがとうございます！

素朴な疑問として、以下の場合どちらが早いのかが気になりました。
この後にforを回して行の総数を数えたりする事になると思うので、提案してもらった通り先にソートをするのか、一度に全部やってしまうのか。

やってみて、良い方で進めます。
