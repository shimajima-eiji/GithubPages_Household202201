<p>オブジェクト指向の良さが活かせない私がハマるポイントです…<br>
今回はPython2系で。</p>

<h1>
<span id="やりたいこと" class="fragment"></span><a href="#%E3%82%84%E3%82%8A%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>やりたいこと</h1>

<ul>
<li>Baseクラスで宣言したものをそれぞれのクラス間で使えるようにしたい</li>
<li>親クラスで子クラスを管理したい
→そもそもこのアプローチが既に設計レベルで問題な気もしますが…</li>
</ul>

<p>ちょっと考えてみました。</p>

<h1>
<span id="クラスの中にクラスを作ってみる方法" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E4%B8%AD%E3%81%AB%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>クラスの中にクラスを作ってみる方法</h1>

<div class="code-frame" data-lang="python">
<div class="code-lang"><span class="bold">inbound_class.py</span></div>
<div class="highlight"><pre><code><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">hoge</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Hoge</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">fuga</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Fuga</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">print_classname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
    <span class="k">print</span> <span class="bp">self</span><span class="p">.</span><span class="n">arg</span><span class="p">,</span> <span class="n">string</span>

  <span class="k">class</span> <span class="nc">Hoge</span><span class="p">:</span>
    <span class="n">__hoge_var</span> <span class="o">=</span> <span class="s">'hoge'</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span>
    <span class="k">def</span> <span class="nf">print_classname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="k">print</span> <span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">+</span> <span class="n">__hoge_var</span>

  <span class="k">class</span> <span class="nc">Fuga</span><span class="p">:</span>
    <span class="n">__fuga_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="s">'fuga'</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span>
    <span class="k">def</span> <span class="nf">print_classname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="k">print</span> <span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">+</span> <span class="n">__fuga_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">print</span> <span class="n">Base</span><span class="p">(</span><span class="s">'test'</span><span class="p">).</span><span class="n">hoge</span><span class="p">.</span><span class="n">print_classname</span><span class="p">()</span>

<span class="c1"># クラスを継承する方法
</span>
<span class="sb">``</span><span class="err">`</span> <span class="n">inheritance</span><span class="p">.</span><span class="n">py</span>
<span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">hoge</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Hoge</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">fuga</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Fuga</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Hoge</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
  <span class="n">__hoge_var</span> <span class="o">=</span> <span class="s">'hoge'</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span>
  <span class="k">def</span> <span class="nf">print_classname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">().</span><span class="n">print_classname</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">+</span> <span class="n">__hoge_var</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Fuga</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
  <span class="n">__fuga_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="s">'fuga'</span><span class="p">]</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">print_classname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">().</span><span class="n">print_classname</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">arg</span> <span class="o">+</span> <span class="n">__fuga_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">print</span> <span class="n">Base</span><span class="p">(</span><span class="s">'test'</span><span class="p">).</span><span class="n">hoge</span><span class="p">.</span><span class="n">print_classname</span><span class="p">()</span>
</code></pre></div>
</div>

<h1>
<span id="課題" class="fragment"></span><a href="#%E8%AA%B2%E9%A1%8C"><i class="fa fa-link"></i></a>課題</h1>

<p>なんとなくやりたい事は伝わればいいんですが、要は同じ要素をそれぞれの子クラスに入れるんじゃなくて、親クラスに入れて子クラスからもそれぞれに呼べるようにしたい、と。<br>
そういう話なんですが、こういう事をやる場合はdefだと上位の階層に変数を定義するとか、classだとselfとかが使えますね。</p>

<p>とはいうものの、上記コードはエラーになります。<br>
正直、この辺り（やりたい事は上記、ただし実装をどうすれば良いか、よく分からなかっていない）でいつもdefをネストして作っています。<br>
defのネストも好きじゃないのでやりたくないんですが、こちらの方が直感的というか、とりあえず動くものが出来るんで扱いやすいんですよね。<br>
このコードもclassをdefに変えてメソッドのselfを消したら期待した通りに動くものになります。<br>
defでネストしまくればやりたい事は実現できていますが、あまりにもスマートからかけ離れていることと、見やすくするためだけにdefを使っている面があるので、あんまり良い使い方・作り方ではありません。</p>
